<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="devster.semi.mapper.QboardMapper">
    <select id="getTotalCount" resultType="int">
        select count(*) from qboard
    </select>
    <select id="getAllPosts" resultType="QboardDto">
        select * from qboard order by qb_idx desc
    </select>
    <select id="getPagingList" parameterType="Map" resultType="QboardDto">
        select * from qboard order by qb_idx desc limit #{start},#{perpage}
    </select>
    <insert id="insertPost" parameterType="QboardDto">
        insert into qboard(m_idx, qb_subject, qb_content, qb_photo, qb_writeday) VALUES
        (#{m_idx},#{qb_subject},#{qb_content},#{qb_photo},now())
    </insert>
    <delete id="deletePost" parameterType="int">
        delete from qboard where qb_idx=#{qb_idx}
    </delete>
    <update id="updatePost" parameterType="QboardDto">
        update qboard set qb_subject=#{qb_subject} ,qb_content=#{qb_content}, qb_photo=#{qb_photo} where qb_idx=#{qb_idx}
    </update>
    <select id="getOnePost" parameterType="int" resultType="QboardDto">
        select * from qboard where qb_idx = #{qb_idx}
    </select>
    <select id="selectNickNameOfMidx" parameterType="int" resultType="String">
        SELECT m.m_nickname
        FROM qboard qb
                 JOIN member m ON qb.m_idx = m.m_idx
        WHERE qb.qb_idx = #{qb_idx}
    </select>
    <update id="updateReadCount" parameterType="int">
        update qboard set qb_readcount=qb_readcount+1 where qb_idx=#{qb_idx}
    </update>
    <update id="increaseLikeCount" parameterType="int">
        update qboard set qb_like=qb_like+1 where qb_idx=#{qb_idx}
    </update>
    <update id="increaseDislikeCount" parameterType="int">
        update qboard set qb_dislike=qb_dislike+1 where qb_idx=#{qb_idx}
    </update>
</mapper>