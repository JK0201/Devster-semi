<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="devster.semi.mapper.ReviewMapper">
    <insert id="insertreview" parameterType="reviewDto">
        insert into reviewboard (rb_type, rb_content, rb_star,m_idx,ci_idx)
        values (#{rb_type}, #{rb_content}, #{rb_star},#{m_idx},#{ci_idx})
    </insert>

    <select id="GetAllReview" resultType="reviewDto">
        select * from reviewboard desc
    </select>

    <select id="getTotalcount" resultType="int">
        select count(*) from reviewboard order by rb_idx desc
    </select>
    <select id="getPagingList" parameterType="Map" resultType="reviewDto">
        select * from reviewboard limit #{start},#{perPage}
    </select>
    <select id="Getmidx" parameterType="int" resultType="reviewDto">
        select * from reviewboard where m_idx = #{m_idx}
    </select>
    <select id="selectnicnameofmidx" parameterType="int" resultType="String">
        SELECT m.m_nickname
        FROM reviewboard re
                 JOIN member m ON re.m_idx = m.m_idx
        WHERE re.m_idx = #{m_idx}
        ORDER BY re.rb_idx desc
           LIMIT 1
    </select>
    <delete id="deletereview" parameterType="int">
        delete from reviewboard where rb_idx=#{rb_idx}
    </delete>
    <update id="updatereview" parameterType="reviewDto">
        update reviewboard set rb_content=#{rb_content} ,rb_star=#{rb_star} ,rb_type=#{rb_type},ci_idx=#{ci_idx}  where rb_idx=#{rb_idx}
    </update>
    <select id="getData" parameterType="int" resultType="reviewDto">
        select * from reviewboard where rb_idx=#{rb_idx}
    </select>
    <update id="increaseLikeCount" parameterType="int">
        update reviewboard set rb_like=rb_like+1 where rb_idx=#{rb_idx}
    </update>
    <update id="increaseDislikeCount" parameterType="int">
        update reviewboard set rb_dislike=rb_dislike+1 where rb_idx=#{rb_idx}
    </update>
    <!--회사 정보 출력-->
    <select id="selectciname" resultType="String">
        select ci_name,ci_idx from companyinfo
    </select>

    <select id="getDataciinfo" parameterType="int" resultType="CompanyinfoDto">
        select * from companyinfo where ci_idx=#{ci_idx}
    </select>

</mapper>